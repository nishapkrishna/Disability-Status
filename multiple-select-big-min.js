!function(t,i,e,s){function o(i,e){this.options=t.extend({},o.DEFAULTS,e),this.$element=t(i),this.init(),this.$element.data("value",null),this.$element.data("count",this.length),this.$element.data("options",this.options.data)}o.DEFAULTS={data:[],size:100,text:"selectmultiple",placeholder:"search"},o.prototype={init:function(){this.$element.empty(),this.optionPage=1,this.page=1,this.scrollAmount=0,this.length=this.options.data.length,this.select=[];for(var e=0;e<this.length;e++)this.select[e]=!1;this.$element.addClass("btn-group"),this.$element.addClass("show-tick"),this.$element.css("width","100%"),this.$buttonsearch=t('<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">').css({width:"100%",padding:"5px 6px 2px 6px"}).appendTo(this.$element),this.$buttontext=t("<span>").text(this.options.text).css({width:"120px",display:"inline-block",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}).appendTo(this.$buttonsearch),this.$buttoniconspan=t('<span class="caret"> ').css({"margin-left":"10px","margin-top":"-10px"}).appendTo(this.$buttonsearch),this.$menu=t('<div class="dropdown-menu" >').css({width:"100%",padding:"10px"}).appendTo(this.$element),this.$input=t('<input type="text" class="input form-control" >').css({"margin-top":"6px",width:this.width-30+"px"}).prop("placeholder",this.options.placeholder).appendTo(this.$menu),this.$select=t('<select multiple size="15" >').css({width:"100%","margin-top":"6px"}).appendTo(this.$menu),this.length>this.options.size&&(this.$buttonloadall=t('<button type="button" class="btn btn-default btn-xs btn-secondary">').css({width:"100%","margin-top":"10px"}).text("deselect all").appendTo(this.$menu),this.$buttonloadall.off("click").on("click",t.proxy(function(){this.deselectAll(),this.$buttontext.html(this.options.text)},this))),this.load(this.options.size);var s=!1;t(i).keydown(function(t){17===t.which&&(s=!0)}).keyup(function(t){17===t.which&&(s=!1)}),this.$input.off("change paste keyup").on("change paste keyup",t.proxy(function(){""===this.$input.val()?(this.page=1,this.load(this.options.size)):(this.page=1,this.optionPage=1,this.search(this.$input.val()))},this)),this.$select.off("change").on("change",t.proxy(function(){var i=[],e=[],o=0;if(this.$select.children().filter(":selected").each(function(e,s){i[e]=parseInt(t(s).prop("id"))}),s)for(var n=0;n<this.length;n++)i.indexOf(n)!==-1&&(this.select[n]=!0,e.push(this.options.data[n]));else for(var n=0;n<this.length;n++)i.indexOf(n)!==-1?(this.select[n]=!0,e.push(this.options.data[n])):this.select[n]=!1;for(var h=0;h<this.length;h++)this.select[h]&&o++;e=0===e.length?null:e,this.$element.data("value",e),this.$element.data("count",o),this.$buttontext.html(e.join(";")),this.$buttonsearch.trigger("multiple_select_change")},this)),this.$select.on("scroll",t.proxy(function(){this.$select.scrollTop()+this.$select.innerHeight()>=this.$select[0].scrollHeight&&this.page*this.options.size<this.length&&(this.scrollAmount=this.$select.scrollTop(),""===this.$input.val()?this.appendItems():(this.optionPage++,this.search(this.$input.val())))},this)),this.$menu.click(function(t){t.stopPropagation()})},load:function(t){t===this.length?this.page=this.length/this.options.size+1:this.page=1,t=t>this.length?this.length:t;for(var i="",e=0;e<t;e++)i+=this.select[e]?'<option id="'+e+'" selected>'+this.options.data[e]+"</option>":'<option id="'+e+'" >'+this.options.data[e]+"</option>";this.$select.html(i)},appendItems:function(){for(var t="",i=this.page*this.options.size,e=i+this.options.size>=this.length?this.length:i+this.options.size,s=i;s<e;s++)t+=this.select[s]?'<option id="'+s+'" selected>'+this.options.data[s]+"</option>":'<option id="'+s+'" >'+this.options.data[s]+"</option>";this.page++,this.$select.append(t),this.$select.scrollTop(this.scrollAmount)},search:function(t){for(var i="",e=this.optionPage*this.options.size,s=0,o=0;o<this.length;o++)this.options.data[o].indexOf(t)!==-1&&s<=e&&(s++,i+=this.select[o]?'<option id="'+o+'" selected>'+this.options.data[o]+"</option>":'<option id="'+o+'" >'+this.options.data[o]+"</option>");this.$select.html(i),this.$select.scrollTop(this.scrollAmount)},selectAll:function(t){null===t&&(t=!0);for(var i=0;i<this.length;i++)this.select[i]=t;this.load(this.options.size),this.$element.data("count",0),this.$element.data("value",t?this.options.data:null),this.$buttonsearch.trigger("multiple_select_change")},deselectAll:function(){this.selectAll(!1)}},t.fn.selectmultiple=function(i){var e=arguments;return"value"===i?this.data("value"):"count"===i?this.data("count"):"option"===i?this.data("options"):this.each(function(){"object"==typeof i?t.data(this,"plugin_selectmultiple",new o(this,i)):o.prototype[i]?void 0!==t.data(this,"plugin_selectmultiple")&&t.data(this,"plugin_selectmultiple")[i].apply(t.data(this,"plugin_selectmultiple"),e):t.error("Method "+i+" does not exist on multiselect")})}}(jQuery,window,document);